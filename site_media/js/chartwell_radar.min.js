// ********************************************************************************
//
//     FF Chartwell Web
//     Radar module
//
//     (c) 2012 FontShop International, http://fontfont.com
//
//     Commercial product, may not be redistributed.
//
// ********************************************************************************


var radarCounterWidth=813;var radarDiameter=713;var radarMargin=10;supportedChartTypes.push("radar");log("Radar module loaded.");Chart.prototype.radar_normalizeValue=function(a){if(parseInt(a)){if(a<0){a=0}else if(a>100){a=100}}return a};Chart.prototype.radar_valueType=function(a){if(parseInt(a)||a==0){return"value"}else{return"grid"}};Chart.prototype.radar_chartWidth=function(){return Math.ceil(this.inScale(radarCounterWidth+2*radarMargin))};Chart.prototype.radar_chartHeight=function(){return Math.ceil(this.inScale(radarDiameter+2*radarMargin))};Chart.prototype.radar_draw=function(){log("Drawing canvas *"+this.ID+"* of type *"+this.type+"*");if(this.amountOfValues()>=3&&this.amountOfValues()<=10){var a=Array(radarCounterWidth/2+radarMargin,radarDiameter+radarMargin);var b=Array(radarCounterWidth/2+radarMargin,radarDiameter/2+radarMargin);var c=radarDiameter/2;var d=Array();for(g=0;g<=this.amountOfValues()-1;g++){d.push(RotatePointAroundPoint(b,a,-1*g/this.amountOfValues()*360))}if(this.values[0].type=="grid"){j=this.values[0];if(j.value.has("a")){var e=10}else if(j.value.has("b")){var e=5}else if(j.value.has("c")){var e=4}else if(j.value.has("d")){var e=2}else if(j.value.has("e")){var e=1}this.canvasContext.lineWidth=this.inScale(6);this.canvasContext.strokeStyle=j.color.toHex();if(j.value.has("x")){for(l=0;l<d.length;l++){outsidePoint=d[l];this.canvasContext.beginPath();this.canvasContext.moveTo(this.inScale(b[0]),this.inScaleY(b[1]));this.canvasContext.lineTo(this.inScale(outsidePoint[0]),this.inScaleY(outsidePoint[1]));this.canvasContext.stroke()}}if(j.value.has("f")){this.canvasContext.beginPath();this.canvasContext.moveTo(this.inScale(d[0][0]),this.inScaleY(d[0][1]));for(l=1;l<d.length;l++){outsidePoint=d[l];this.canvasContext.lineTo(this.inScale(outsidePoint[0]),this.inScaleY(outsidePoint[1]))}this.canvasContext.fillStyle=j.color.toHex();this.canvasContext.fill()}else{for(g=0;g<e;g++){this.canvasContext.beginPath();outsidePoint=d[0];var f=Array(Interpolate(b[0],outsidePoint[0],(g+1)/e),Interpolate(b[1],outsidePoint[1],(g+1)/e));this.canvasContext.moveTo(this.inScale(f[0]),this.inScaleY(f[1]));for(l=1;l<d.length;l++){outsidePoint=d[l];var f=Array(Interpolate(b[0],outsidePoint[0],(g+1)/e),Interpolate(b[1],outsidePoint[1],(g+1)/e));this.canvasContext.lineTo(this.inScale(f[0]),this.inScaleY(f[1]))}outsidePoint=d[0];var f=Array(Interpolate(b[0],outsidePoint[0],(g+1)/e),Interpolate(b[1],outsidePoint[1],(g+1)/e));this.canvasContext.lineTo(this.inScale(f[0]),this.inScaleY(f[1]));this.canvasContext.lineWidth=this.inScale(6);this.canvasContext.strokeStyle=j.color.toHex();this.canvasContext.stroke()}}}var h=0;for(var i=0;i<this.values.length;i++){var j=this.values[i];if(j.type=="value"){if(i==this.values.length-1){if(this.values[0].type!="value"){var k=this.values[1];var m=0}else{var k=this.values[0];var m=0}}else{var k=this.values[i+1];var m=h+1}this.canvasContext.beginPath();this.canvasContext.moveTo(this.inScale(b[0]),this.inScaleY(b[1]));var n=Array(Interpolate(b[0],d[h][0],j.value/100),Interpolate(b[1],d[h][1],j.value/100));this.canvasContext.lineTo(this.inScale(n[0]),this.inScaleY(n[1]));var o=Array(Interpolate(b[0],d[m][0],k.value/100),Interpolate(b[1],d[m][1],k.value/100));this.canvasContext.lineTo(this.inScale(o[0]),this.inScaleY(o[1]));this.canvasContext.closePath();this.canvasContext.fillStyle=j.color.toHex();this.canvasContext.fill();h+=1}}}else{warning("Chartwell Radar: Wrong amount of values. Must be between 3 and 10, but is "+this.amountOfValues()+".")}}